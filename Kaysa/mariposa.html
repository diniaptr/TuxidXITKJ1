<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Mariposa</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

    <style>
        .btn-date { min-width: 80px; }
        .cinema-card { border: 1px solid #ddd; border-radius: 10px; padding: 15px; margin-bottom: 10px; }
        .time-slot-container { display: flex; flex-wrap: wrap; gap: 10px; } /* Jarak antar tombol */
    </style>
</head>
<body>
    
<a href="../Auliya/index.html" class="btn btn-outline-secondary m-4" >
    <i class="bi bi-arrow-left" ></i>  
</a>

<div class="container mt-4">
    <!-- Detail Film -->
    <div class="row">
        <div class="col-md-4">
          
                <img src="https://assets.jalantikus.com/assets/cache/0/0/userfiles/2020/09/15/poster-film-indonesia-terbaru-55755.jpg"  class="img-fluid rounded" alt="Poster Film" style="width: 100%; max-width: 400px; cursor: pointer;">
            </a>
        </div>
        <div class="col-md-8">
            <h2>Mariposa</h2>
            <p><strong>Genre:</strong> Drama, Remaja, Roman, Komedi</p>
            <p><strong>Durasi:</strong> 1 jam 58 menit</p>
            <p><strong>Sutradara:</strong> Fajar Bustomi</p>
            <p><strong>Rating Usia:</strong> <span class="badge bg-secondary">R15+</span></p>
            
            <div class="d-flex align-items-center">
                <h4 class="me-2 text-warning">7.0</h4>
                <span>‚òÖ‚òÖ‚òÖ‚òÜ‚òÜ (2.004 Vote)</span>
            </div>

            <button class="btn btn-outline-danger mt-3"><i class="bi bi-heart"></i> Masukkan Watchlist</button>
            <button class="btn btn-outline-danger mt-3" onclick="window.open('https://youtu.be/N9PUbRIKYOA?si=lwFOsX-S0pw9J_Hy', '_blank')">
                Tonton Trailer
              </button>
        </div>
    </div>

    <hr>

    <!-- Sinopsis -->
    <h5 class="border-bottom pb-2">Sinopsis</h5>
    <p>Mariposa (Kupu-kupu) seperti kamu, aku mengejar tapi kamu menghindar.
       Begitulah gambaran sosok Iqbal Guanna bagi Nastasha Kay Loovy atau Acha. Acha bertekad ingin mendapatkan hati Iqbal, seorang cowok cakep, pintar dan dikenal berhati dingin. Sahabat Acha, Amanda, berusaha mencegah niat Acha untuk mendekati Iqbal. 
       Amanda takut Acha akan terluka dan sakit hati.</p>
    <hr>

    <!-- Slider Tanggal -->
    <h4>Jadwal Tayang</h4>
    <div class="d-flex flex-wrap gap-2">
        <button class="btn btn-primary btn-date">4 Juni HARI INI</button>
        <button class="btn btn-outline-secondary btn-date">5 Juni KAM</button>
        <button class="btn btn-outline-secondary btn-date">6 Juni JUM</button>
        <button class="btn btn-outline-secondary btn-date">7 Juni SAB</button>
        <button class="btn btn-outline-secondary btn-date">8 Juni MIN</button>
    </div>

    <hr>

    <!-- Jadwal Bioskop -->
    <div class="cinema-card">
        <h5><span class="text-warning">‚≠ê</span> MARVELL CITY CGV <span class="badge bg-danger">CGV</span></h5>
        <p><small>2.73 km ¬∑ Marvel City Mall 2nd floor, Jl. Ngagel No 123, Surabaya</small></p>
        
        <h6>REGULAR 2D - Rp30.000</h6>
        <div class="time-slot-container">
            <button class="btn btn-outline-primary">12:10</button>
            <button class="btn btn-outline-primary">14:30</button>
            <button class="btn btn-outline-primary">17:00</button>
            <button class="btn btn-outline-primary">19:30</button>
            <button class="btn btn-outline-primary">20:45</button>
        </div>
    </div>

    <div class="cinema-card">
        <h5><span class="text-warning">‚≠ê</span> BG JUNCTION CGV <span class="badge bg-danger">CGV</span></h5>
        <p><small>Jl. Bubutan, No.1-7, Kec. Bubutan, Surabaya</small></p>
        
        <h6>REGULAR 2D - Rp30.000</h6>
        <div class="time-slot-container">
            <button class="btn btn-outline-primary">12:45</button>
            <button class="btn btn-outline-primary">14:30</button>
            <button class="btn btn-outline-primary">17:15</button>
            <button class="btn btn-outline-primary">19:30</button>
            <button class="btn btn-outline-primary">22:00</button>
        </div>
    </div>

    <div class="cinema-card">
        <h5><span class="text-warning">‚≠ê</span> CIPUTRA WORLD XXI <span class="badge bg-danger">XXI</span></h5>
        <p><small>Ciputra World lt.4 jl. Mayjend Sungkono no.86, Surabaya</small></p>
        
        <h6>REGULAR 2D - Rp30.000</h6>
        <div class="time-slot-container">
            <button class="btn btn-outline-primary">12:15</button>
            <button class="btn btn-outline-primary">14:30</button>
            <button class="btn btn-outline-primary">17:25</button>
            <button class="btn btn-outline-primary">19:30</button>
            <button class="btn btn-outline-primary">21:00</button>
        </div>
    </div>

    <div class="cinema-card">
        <h5><span class="text-warning">‚≠ê</span> ROYAL XXI <span class="badge bg-danger">XXI</span></h5>
        <p><small>Royal Plaza lt.3, Jl. Jend A Yani, Surabaya</small></p>
        
        <h6>REGULAR 2D - Rp30.000</h6>
        <div class="time-slot-container">
            <button class="btn btn-outline-primary">13:00</button>
            <button class="btn btn-outline-primary">14:40</button>
            <button class="btn btn-outline-primary">16:20</button>
            <button class="btn btn-outline-primary">20:25</button>
        </div>
    </div>

    <div class="cinema-card">
        <h5><span class="text-warning">‚≠ê</span> PAKUWON MALL XXI <span class="badge bg-danger">XXI</span></h5>
        <p><small>Pakuwon mall lt.2M,jl. Puncak indah lontar no.2, Surabaya</small></p>
        
        <h6>REGULAR 2D - Rp30.000</h6>
        <div class="time-slot-container">
            <button class="btn btn-outline-primary">12:30</button>
            <button class="btn btn-outline-primary">14:10</button>
            <button class="btn btn-outline-primary">15:50</button>
            <button class="btn btn-outline-primary">21:15</button>
        </div>
    </div>

    <div class="cinema-card">
        <h5><span class="text-warning">‚≠ê</span> LENMARC XXI <span class="badge bg-danger">XXI</span></h5>
        <p><small>Lenmarc Mall lt.4, Jl. Raya Lontar Bukit Darmo Golf, Surabaya</small></p>
        
        <h6>REGULAR 2D - Rp30.000</h6>
        <div class="time-slot-container">
            <button class="btn btn-outline-primary">12:45</button>
            <button class="btn btn-outline-primary">14:20</button>
            <button class="btn btn-outline-primary">17:45</button>
            <button class="btn btn-outline-primary">20:00</button>
            <button class="btn btn-outline-primary">21:15</button>
        </div>
    </div>

    <div class="cinema-card">
        <h5><span class="text-warning">‚≠ê</span> DELTA XXI <span class="badge bg-danger">XXI</span></h5>
        <p><small>Plaza Surabaya lt. 5, Jl. Pemuda No. 31-37, Surabaya</small></p>
        
        <h6>REGULAR 2D - Rp30.000</h6>
        <div class="time-slot-container">
            <button class="btn btn-outline-primary">13:00</button>
            <button class="btn btn-outline-primary">15:20</button>
            <button class="btn btn-outline-primary">17:45</button>
            <button class="btn btn-outline-primary">20:00</button>
        </div>
    </div>

    <div class="text-center mt-4">
        <button class="btn btn-dark btn-lg">üéü BELI TIKET</button>
    </div>
</div>

<!-- Modal Pilih Kursi -->
<div class="modal fade" id="seatModal" tabindex="-1" aria-labelledby="seatModalLabel" aria-hidden="true">
    <div id="daftarKursi" class="d-flex flex-wrap gap-2"></div>
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="seatModalLabel">Pilih Kursi</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Tutup"></button>
      </div>
      <div id="alertBerhasil" class="alert alert-success alert-dismissible fade show d-none mt-3" role="alert">
  Pembayaran berhasil!
  <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
</div>
           
      <div class="modal-body">
        <div class="d-flex flex-wrap gap-2" id="seatContainer"></div>
        <div class="mt-4">
          <h6>Total Harga: Rp<span id="totalPrice">0</span></h6>
        </div>
      </div>
      <div class="modal-footer flex-column align-items-start w-100">
  <div class="w-100 mb-3">
    <label for="metodeBayar" class="form-label">Pilih Metode Pembayaran:</label>
    <select class="form-select" id="metodeBayar">
      <option value="">-- Pilih --</option>
      <option value="transfer">Transfer Bank</option>
      <option value="ewallet">Dana</option>
      <option value="ewallet">ovo</option>
      <option value="ewallet">Gopay</option>
      <option value="ewallet">Shopeepay</option>
    </select>
  </div>
        <button id="bayarButton">Bayar Sekarang</button>
  </div>
        
  <!-- konten halaman kamu -->
  <div class="container">
    <!-- kursi, total harga, dropdown metode, tombol bayar, dll -->
  </div>

  <!-- Toast notifikasi -->
  <div id="toast" style="
      visibility: hidden;
      min-width: 250px;
      margin-left: -125px;
      background-color: #333;
      color: #fff;
      text-align: center;
      border-radius: 8px;
      padding: 16px;
      position: fixed;
      z-index: 1;
      left: 50%;
      bottom: 30px;
      font-size: 17px;
      transition: visibility 0s, opacity 0.5s linear;
      opacity: 0;
  ">
    Pembayaran berhasil!
  </div>

  <!-- Link Ringkasan -->
<div id="linkRingkasanContainer" style="text-align:center; margin-top: 10px; display: none;">
  <a id="linkRingkasan" href="ringkasan order.html" class="btn btn-link">Lihat Ringkasan Order di sini</a>
</div>

  <script>
    document.addEventListener("DOMContentLoaded", function () {
        const now = new Date();

        document.querySelectorAll('button.btn-outline-primary, button.btn-primary').forEach(button => {
            const timeStr = button.innerText.trim();
            const [hours, minutes] = timeStr.split(':');

            const showTime = new Date();
            showTime.setHours(parseInt(hours));
            showTime.setMinutes(parseInt(minutes));
            showTime.setSeconds(0);

            if (showTime <= now) {
                button.disabled = true;
                button.classList.remove('btn-primary', 'btn-outline-primary');
                button.classList.add('btn-secondary');
            }
        });

        // Script pilih jam tayang
        let cinemaCards = document.querySelectorAll(".cinema-card");

        cinemaCards.forEach(cinema => {
            let timeSlots = cinema.querySelectorAll(".btn-outline-primary, .btn-primary");

            timeSlots.forEach(slot => {
    const slotTime = slot.innerText.trim();
    const [hour, minute] = slotTime.split(":").map(Number);
    const now = new Date();
    const slotDate = new Date();

    slotDate.setHours(hour, minute, 0, 0);

    if (slotDate < now) {
        // Custom disable styling pakai JSS (langsung JS)
        slot.style.opacity = "0.6";
        slot.style.cursor = "not-allowed";
        slot.style.pointerEvents = "none"; // biar gak bisa diklik
        slot.dataset.disabled = "true";
    }

    // Tambahin event listener kalau gak disabled
    slot.addEventListener("click", function () {
        if (slot.dataset.disabled === "true") return;

        // logic klik kamu di sini...
        console.log("Jam dipilih:", slotTime);
    });
});
                    if (this.classList.contains("btn-primary")) {
                        this.classList.remove("btn-primary");
                        this.classList.add("btn-outline-primary");
                    } else {
                        timeSlots.forEach(s => {
                            s.classList.remove("btn-primary");
                            s.classList.add("btn-outline-primary");
                        });

                        this.classList.remove("btn-outline-primary");
                        this.classList.add("btn-primary");
                    }
                });
            });
        

</script>
     
<script>
    document.addEventListener("DOMContentLoaded", function () {
        let cinemaCards = document.querySelectorAll(".cinema-card");

        cinemaCards.forEach(cinema => {
            let timeSlots = cinema.querySelectorAll(".btn-outline-primary, .btn-primary");

            timeSlots.forEach(slot => {
                slot.addEventListener("click", function () {
                    // Reset semua pilihan di bioskop lain
                    cinemaCards.forEach(otherCinema => {
                        if (otherCinema !== cinema) {
                            let otherSlots = otherCinema.querySelectorAll(".btn-primary");
                            otherSlots.forEach(s => {
                                s.classList.remove("btn-primary");
                                s.classList.add("btn-outline-primary");
                            });
                        }
                    });

                    // Jika tombol sudah aktif, matikan (warna putih)
                    if (this.classList.contains("btn-primary")) {
                        this.classList.remove("btn-primary");
                        this.classList.add("btn-outline-primary");
                    } else {
                        // Reset semua pilihan dalam bioskop yang sama (hanya satu jam yang bisa dipilih per bioskop)
                        timeSlots.forEach(s => {
                            s.classList.remove("btn-primary");
                            s.classList.add("btn-outline-primary");
                        });

                        // Aktifkan tombol yang diklik (warna biru)
                        this.classList.remove("btn-outline-primary");
                        this.classList.add("btn-primary");
                    }
                });
            });
        });
    });
</script>
  
  <script>
  document.addEventListener("DOMContentLoaded", function () {
    const ticketPrice = 30000;
    let selectedSeats = [];

    const seatContainer = document.getElementById("seatContainer");
    const bayarButton = document.getElementById("bayarButton");
    const metodeBayarSelect = document.getElementById("metodeBayar");
    const beliTiketButton = document.querySelector(".btn-dark");
    const toast = document.getElementById("toast");
    const totalPriceSpan = document.getElementById("totalPrice");

    // Disable tombol beli tiket awalnya
    beliTiketButton.disabled = true;

    // Fungsi untuk mengaktifkan/menonaktifkan tombol Bayar
    function updateBayarButtonState() {
      const metodeValid = metodeBayarSelect.value !== "";
      const kursiDipilih = selectedSeats.length > 0;
      bayarButton.disabled = !(metodeValid && kursiDipilih);
    }

    // Cek dan disable jam tayang yang sudah lewat
    document.querySelectorAll('button.btn-outline-primary, button.btn-primary').forEach(button => {
      const timeStr = button.innerText.trim();
      const [hours, minutes] = timeStr.split(':');
      const now = new Date();
      const showTime = new Date();
      showTime.setHours(parseInt(hours), parseInt(minutes), 0, 0);

      if (showTime <= now) {
        button.disabled = true;
        button.classList.remove('btn-primary', 'btn-outline-primary');
        button.classList.add('btn-secondary');
      }
    });

    // Handle pemilihan jam tayang
    document.querySelectorAll(".cinema-card").forEach(cinema => {
      const timeSlots = cinema.querySelectorAll(".btn-outline-primary, .btn-primary");

      timeSlots.forEach(slot => {
        slot.addEventListener("click", function () {
          // Reset semua pilihan di bioskop lain
          document.querySelectorAll(".cinema-card").forEach(otherCinema => {
            if (otherCinema !== cinema) {
              otherCinema.querySelectorAll(".btn-primary").forEach(s => {
                s.classList.remove("btn-primary");
                s.classList.add("btn-outline-primary");
              });
            }
          });

          // Atur toggle tombol terpilih
          timeSlots.forEach(s => {
            s.classList.remove("btn-primary");
            s.classList.add("btn-outline-primary");
          });
          this.classList.remove("btn-outline-primary");
          this.classList.add("btn-primary");

          // Aktifkan tombol beli tiket
          beliTiketButton.disabled = false;
        });
      });
    });

    function generateSeats() {
      seatContainer.innerHTML = "";
      const rows = 5, cols = 12;
      const rowLetters = ['A','B','C','D','E','F','G','H','I','J'];

      for (let i = 0; i < rows; i++) {
        const row = document.createElement("div");
        row.className = "d-flex justify-content-center gap-2";

        for (let j = 1; j <= cols; j++) {
          if (j === 5 || j === 9) {
            const spacer = document.createElement("div");
            spacer.className = "mx-2";
            row.appendChild(spacer);
          }

          const seatNumber = rowLetters[i] + j;
          const seat = document.createElement("button");
          seat.className = "btn btn-outline-secondary m-0";
          seat.style.width = "50px";
          seat.style.height = "50px";
          seat.innerText = seatNumber;
          seat.dataset.seat = seatNumber;

          seat.addEventListener("click", function () {
            if (seat.classList.contains("btn-outline-secondary")) {
              seat.classList.remove("btn-outline-secondary");
              seat.classList.add("btn-success");
              selectedSeats.push(seatNumber);
            } else {
              seat.classList.remove("btn-success");
              seat.classList.add("btn-outline-secondary");
              selectedSeats = selectedSeats.filter(s => s !== seatNumber);
            }

            updateTotalPrice();
            updateBayarButtonState(); // periksa apakah tombol bisa diaktifkan
          });

          row.appendChild(seat);
        }

        seatContainer.appendChild(row);
      }
    }

    function updateTotalPrice() {
      const total = selectedSeats.length * ticketPrice;
      totalPriceSpan.innerText = total.toLocaleString("id-ID");
    }

    function showToast() {
  toast.style.visibility = "visible";
  toast.style.opacity = "1";

  // Toast tetap 3 detik, tapi link tetap muncul setelah itu
  setTimeout(() => {
    toast.style.opacity = "0";
    toast.style.visibility = "hidden";
  }, 3000);

  // Langsung tampilkan link ringkasan (tidak menunggu toast hilang)
  const ringkasanDiv = document.getElementById("linkRingkasanContainer");
const ringkasanLink = document.getElementById("linkRingkasan");

const kursiParam = selectedSeats.join(", ");
const totalHarga = selectedSeats.length * ticketPrice;

// Ambil judul dan poster dari film yang aktif
const selectedCinema = document.querySelector(".cinema-card:has(.btn-primary)");
const judulFilm = selectedCinema?.dataset.title || "Mariposa";
const posterFilm = selectedCinema?.dataset.poster || "https://assets.jalantikus.com/assets/cache/0/0/userfiles/2020/09/15/poster-film-indonesia-terbaru-55755.jpg"

// Kirim semua data ke halaman ringkasan
const queryParams = new URLSearchParams({
  kursi: kursiParam,
  harga: totalHarga,
  judul: judulFilm,
  poster: posterFilm
});

ringkasanLink.href = "ringkasan order.html?" + queryParams.toString();
ringkasanDiv.style.display = "block";
}

    // Klik tombol Beli Tiket
    beliTiketButton.addEventListener("click", () => {
      selectedSeats = [];
      generateSeats();
      updateTotalPrice();

      // Reset dropdown dan tombol bayar
      metodeBayarSelect.value = "";
      bayarButton.disabled = true;

      new bootstrap.Modal(document.getElementById("seatModal")).show();
    });

    // Handle perubahan metode pembayaran
    metodeBayarSelect.addEventListener("change", updateBayarButtonState);

    // Klik tombol Bayar Sekarang
    bayarButton.addEventListener("click", function () {
      showToast();
    });
  });
</script>